INFO:root:Namespace(model_name='NeuMF', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2025-12-15 19:58:18 ---------------------------------------------
INFO:root:
======================================
 Arguments          | Values          
======================================
 batch_size         | 256            
 data_appendix      |                
 dataset            | lastfm         
 dropout            | 0              
 early_stop         | 10             
 emb_size           | 64             
 epoch              | 200            
 eval_batch_size    | 256            
 gpu                | 0              
 l2                 | 0              
 layers             | [64]           
 lr                 | 0.001          
 main_metric        |                
 num_neg            | 1              
 num_workers        | 0              
 optimizer          | Adam           
 random_seed        | 0              
 save_final_results | 1              
 test_all           | 1              
 topk               | [5, 10, 20, 50]
======================================
INFO:root:Device: cpu
INFO:root:Load corpus from ../data/lastfm\BaseReader.pkl
INFO:root:#params: 2507712
INFO:root:NeuMF(
  (mf_u_embeddings): Embedding(1893, 64)
  (mf_i_embeddings): Embedding(17633, 64)
  (mlp_u_embeddings): Embedding(1893, 64)
  (mlp_i_embeddings): Embedding(17633, 64)
  (mlp): ModuleList(
    (0): Linear(in_features=128, out_features=64, bias=True)
  )
  (dropout_layer): Dropout(p=0, inplace=False)
  (prediction): Linear(in_features=128, out_features=1, bias=False)
)
INFO:root:Namespace(model_name='NeuMF', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2025-12-15 23:34:10 ---------------------------------------------
INFO:root:
======================================
 Arguments          | Values          
======================================
 batch_size         | 256            
 data_appendix      |                
 dataset            | lastfm         
 dropout            | 0              
 early_stop         | 10             
 emb_size           | 64             
 epoch              | 200            
 eval_batch_size    | 256            
 gpu                | 0              
 l2                 | 0              
 layers             | [64]           
 lr                 | 0.001          
 main_metric        |                
 num_neg            | 1              
 num_workers        | 0              
 optimizer          | Adam           
 random_seed        | 0              
 save_final_results | 1              
 test_all           | 1              
 topk               | [5, 10, 20, 50]
======================================
INFO:root:Device: cpu
INFO:root:Reading data from "../data/", dataset = "lastfm" 
INFO:root:Counting dataset statistics...
INFO:root:"# user": 1892, "# item": 17632, "# entry": 92834
INFO:root:Save corpus to ../data/lastfm\BaseReader.pkl
INFO:root:#params: 2507712
INFO:root:NeuMF(
  (mf_u_embeddings): Embedding(1893, 64)
  (mf_i_embeddings): Embedding(17633, 64)
  (mlp_u_embeddings): Embedding(1893, 64)
  (mlp_i_embeddings): Embedding(17633, 64)
  (mlp): ModuleList(
    (0): Linear(in_features=128, out_features=64, bias=True)
  )
  (dropout_layer): Dropout(p=0, inplace=False)
  (prediction): Linear(in_features=128, out_features=1, bias=False)
)
INFO:root:Test Before Training: (HR@5:0.0011,NDCG@5:0.0004,HR@10:0.0032,NDCG@10:0.0011,HR@20:0.0053,NDCG@20:0.0016,HR@50:0.0096,NDCG@50:0.0025)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.4301 [12.5 s]	val=(HR@5:0.0770,NDCG@5:0.0607) [169.7 s] *
INFO:root:Epoch 2     loss=0.3159 [9.7 s]	val=(HR@5:0.0866,NDCG@5:0.0655) [162.1 s] *
INFO:root:Epoch 3     loss=0.2692 [10.1 s]	val=(HR@5:0.1508,NDCG@5:0.1116) [154.5 s] *
INFO:root:Epoch 4     loss=0.1847 [11.1 s]	val=(HR@5:0.2066,NDCG@5:0.1464) [156.3 s] *
INFO:root:Epoch 5     loss=0.1077 [10.8 s]	val=(HR@5:0.2390,NDCG@5:0.1669) [159.6 s] *
INFO:root:Epoch 6     loss=0.0654 [9.7 s]	val=(HR@5:0.2539,NDCG@5:0.1743) [162.3 s] *
INFO:root:Epoch 7     loss=0.0455 [11.9 s]	val=(HR@5:0.2629,NDCG@5:0.1779) [163.9 s] *
INFO:root:Epoch 8     loss=0.0332 [10.1 s]	val=(HR@5:0.2655,NDCG@5:0.1798) [162.6 s] *
INFO:root:Epoch 9     loss=0.0268 [10.0 s]	val=(HR@5:0.2443,NDCG@5:0.1745) [158.2 s]
INFO:root:Epoch 10    loss=0.0228 [10.8 s]	val=(HR@5:0.2671,NDCG@5:0.1853) [153.8 s] *
INFO:root:Epoch 11    loss=0.0199 [12.0 s]	val=(HR@5:0.2719,NDCG@5:0.1926) [150.2 s] *
INFO:root:Epoch 12    loss=0.0170 [9.7 s]	val=(HR@5:0.2634,NDCG@5:0.1964) [165.7 s] *
INFO:root:Epoch 13    loss=0.0157 [10.6 s]	val=(HR@5:0.2735,NDCG@5:0.1984) [153.8 s] *
INFO:root:Epoch 14    loss=0.0141 [10.9 s]	val=(HR@5:0.2634,NDCG@5:0.1968) [167.6 s]
INFO:root:Epoch 15    loss=0.0133 [7.0 s]	val=(HR@5:0.2554,NDCG@5:0.1910) [174.6 s]
INFO:root:Epoch 16    loss=0.0123 [7.2 s]	val=(HR@5:0.2645,NDCG@5:0.1959) [157.3 s]
INFO:root:Epoch 17    loss=0.0111 [7.0 s]	val=(HR@5:0.2586,NDCG@5:0.1869) [163.9 s]
INFO:root:Epoch 18    loss=0.0104 [7.1 s]	val=(HR@5:0.2576,NDCG@5:0.1850) [173.4 s]
INFO:root:Epoch 19    loss=0.0102 [7.3 s]	val=(HR@5:0.2655,NDCG@5:0.1907) [157.1 s]
INFO:root:Epoch 20    loss=0.0094 [6.8 s]	val=(HR@5:0.2671,NDCG@5:0.1894) [155.8 s]
INFO:root:Epoch 21    loss=0.0091 [7.2 s]	val=(HR@5:0.2560,NDCG@5:0.1788) [151.4 s]
INFO:root:Epoch 22    loss=0.0090 [7.0 s]	val=(HR@5:0.2682,NDCG@5:0.1887) [158.2 s]
INFO:root:Early stop at 22 based on val result.
INFO:root:
Best Iter(val)=   13	 val=(HR@5:0.2735,NDCG@5:0.1984) [3740.1 s] 
INFO:root:Load model from ../model/NeuMF/NeuMF__lastfm__0__lr=0.001__l2=0__emb_size=64__layers=[64].pt
INFO:root:
Val  After Training: (HR@5:0.2735,NDCG@5:0.1984,HR@10:0.3611,NDCG@10:0.2266,HR@20:0.4509,NDCG@20:0.2491,HR@50:0.5651,NDCG@50:0.2719)
INFO:root:
Test After Training: (HR@5:0.3206,NDCG@5:0.2415,HR@10:0.4135,NDCG@10:0.2712,HR@20:0.4952,NDCG@20:0.2920,HR@50:0.6136,NDCG@50:0.3154)
INFO:root:Saving top-100 recommendation results to: ../log/NeuMF\NeuMF__lastfm__0__lr=0\rec-NeuMF-dev.csv
INFO:root:dev Prediction results saved!
INFO:root:Saving top-100 recommendation results to: ../log/NeuMF\NeuMF__lastfm__0__lr=0\rec-NeuMF-test.csv
INFO:root:test Prediction results saved!
INFO:root:
--------------------------------------------- END: 2025-12-16 00:50:47 ---------------------------------------------
